package dao;

import java.util.Date;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import org.springframework.orm.ibatis.support.SqlMapClientDaoSupport;

import vo.QldnTramTTDien;
import vo.QldnTramTTNhienLieu;

public class QldnTramTTNhienLieuDAOImpl extends SqlMapClientDaoSupport implements QldnTramTTNhienLieuDAO {

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table QLDN_TRAM_TT_NHIEN_LIEU
     *
     * @ibatorgenerated Mon Jul 03 14:29:15 ICT 2017
     */
    public QldnTramTTNhienLieuDAOImpl() {
        super();
    }

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table QLDN_TRAM_TT_NHIEN_LIEU
     *
     * @ibatorgenerated Mon Jul 03 14:29:15 ICT 2017
     */
    public int deleteByPrimaryKey(Integer id) {
        QldnTramTTNhienLieu key = new QldnTramTTNhienLieu();
        key.setId(id);
        int rows = getSqlMapClientTemplate().delete("QLDN_TRAM_TT_NHIEN_LIEU.ibatorgenerated_deleteByPrimaryKey", key);
        return rows;
    }

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table QLDN_TRAM_TT_NHIEN_LIEU
     *
     * @ibatorgenerated Mon Jul 03 14:29:15 ICT 2017
     */
    public void insert(QldnTramTTNhienLieu record) {
        getSqlMapClientTemplate().insert("QLDN_TRAM_TT_NHIEN_LIEU.ibatorgenerated_insert", record);
    }

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table QLDN_TRAM_TT_NHIEN_LIEU
     *
     * @ibatorgenerated Mon Jul 03 14:29:15 ICT 2017
     */
    public void insertSelective(QldnTramTTNhienLieu record) {
        getSqlMapClientTemplate().insert("QLDN_TRAM_TT_NHIEN_LIEU.ibatorgenerated_insertSelective", record);
    }

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table QLDN_TRAM_TT_NHIEN_LIEU
     *
     * @ibatorgenerated Mon Jul 03 14:29:15 ICT 2017
     */
    public QldnTramTTNhienLieu selectByPrimaryKey(Integer id) {
        QldnTramTTNhienLieu key = new QldnTramTTNhienLieu();
        key.setId(id);
        QldnTramTTNhienLieu record = (QldnTramTTNhienLieu) getSqlMapClientTemplate().queryForObject("QLDN_TRAM_TT_NHIEN_LIEU.ibatorgenerated_selectByPrimaryKey", key);
        return record;
    }

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table QLDN_TRAM_TT_NHIEN_LIEU
     *
     * @ibatorgenerated Mon Jul 03 14:29:15 ICT 2017
     */
    public int updateByPrimaryKeySelective(QldnTramTTNhienLieu record) {
        int rows = getSqlMapClientTemplate().update("QLDN_TRAM_TT_NHIEN_LIEU.ibatorgenerated_updateByPrimaryKeySelective", record);
        return rows;
    }

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table QLDN_TRAM_TT_NHIEN_LIEU
     *
     * @ibatorgenerated Mon Jul 03 14:29:15 ICT 2017
     */
    public int updateByPrimaryKey(QldnTramTTNhienLieu record) {
        int rows = getSqlMapClientTemplate().update("QLDN_TRAM_TT_NHIEN_LIEU.ibatorgenerated_updateByPrimaryKey", record);
        return rows;
    }
   // kiem tra tram da thanh toan nhien lieu chua
	@Override
	public QldnTramTTNhienLieu selectByKey(String idTram, Date tgBatDau,Date ngayChayMf) {
		QldnTramTTNhienLieu key = new QldnTramTTNhienLieu();
        key.setIdTram(idTram);
        key.setNgayChayMf(ngayChayMf);
        key.setTgBatDau(tgBatDau);
        QldnTramTTNhienLieu record = (QldnTramTTNhienLieu) getSqlMapClientTemplate().queryForObject("QLDN_TRAM_TT_NHIEN_LIEU.selectByKey", key);
        return record;
	}

	@SuppressWarnings("unchecked")
	@Override
	public List<QldnTramTTNhienLieu> getData(String loaiThanhToan, String sdate, String edate) {
	    // TODO Auto-generated method stub
	    Map<String, String> parms = new HashMap<String, String>();
	    parms.put("loaiThanhToan", loaiThanhToan);
	    parms.put("edate", edate);
	    parms.put("sdate", sdate);
	   // parms.put("data", null);
	    return getSqlMapClientTemplate().queryForList("QLDN_TRAM_TT_NHIEN_LIEU.getData", parms);
	}

	@Override
	public int getMaxId() {
	    // TODO Auto-generated method stub
	    return (Integer) getSqlMapClientTemplate().queryForObject("QLDN_TRAM_TT_NHIEN_LIEU.getMaxId");
	}
	
	@SuppressWarnings("unchecked")
	@Override
	public List<QldnTramTTNhienLieu> getTkTtNhienLieuTinhListAll(String sdate, String edate, String tinh ) {
		Map<String, Object> parms = new HashMap<String, Object>();
		
		parms.put("P_SDATE", sdate);	
		parms.put("P_EDATE", edate);	
		
		parms.put("P_TINH", tinh);	
		parms.put("P_DATA", null);
			
		return getSqlMapClientTemplate().queryForList("QLDN_TRAM_TT_NHIEN_LIEU.getTkTtNhienLieuTinhListAll", parms);
	}
	
	@SuppressWarnings("unchecked")
	@Override
	public List<QldnTramTTNhienLieu> getTkTtNhienLieuNhieuTinhListAll(String sdate, String edate, String tinh ) {
		Map<String, Object> parms = new HashMap<String, Object>();
		
		parms.put("P_SDATE", sdate);	
		parms.put("P_EDATE", edate);	
		
		parms.put("P_TINH", tinh);	
		parms.put("P_DATA", null);
			
		return getSqlMapClientTemplate().queryForList("QLDN_TRAM_TT_NHIEN_LIEU.getTkTtNhienLieuNhieuTinhListAll", parms);
	}
	
	@SuppressWarnings("unchecked")
	@Override
	public List<QldnTramTTNhienLieu> getTkTheoDonViXHHVTTListAll(String sdate, String edate, String tinh ) {
		Map<String, Object> parms = new HashMap<String, Object>();
		
		parms.put("P_SDATE", sdate);	
		parms.put("P_EDATE", edate);	
		
		parms.put("P_TINH", tinh);	
		parms.put("P_DATA", null);
			
		return getSqlMapClientTemplate().queryForList("QLDN_TRAM_TT_NHIEN_LIEU.getTkTheoDonViXHHVTTListAll", parms);
	}
	
	@SuppressWarnings("unchecked")
	@Override
	public List<QldnTramTTNhienLieu> getTkTtTheoMucListAll(String month, String year, String tinh, Integer dinhmuc1,Integer dinhmuc2, String type ) {
		Map<String, Object> parms = new HashMap<String, Object>();
		
		parms.put("P_TYPE", type);
		parms.put("P_MONTH", month);	
		parms.put("P_YEAR", year);	
		parms.put("P_TINH", tinh);
		parms.put("P_DM1", dinhmuc1);
		parms.put("P_DM2", dinhmuc2);
		parms.put("P_DATA", null);
			
		return getSqlMapClientTemplate().queryForList("QLDN_TRAM_TT_NHIEN_LIEU.getTkTtTheoMucListAll", parms);
	}
	
	/*xuat bang ke hoat dong chay may no. AnhCTV. 15/10/2107*/
	@SuppressWarnings("unchecked")
	@Override
	public List<QldnTramTTNhienLieu> getTramTTNhienLieuList(String ngayChayMfF, String ngayChayMfT, String idTram,
			String loaiNhienLieu, String tinh, String tenXhhVtt, String type, String username) {
		Map<String, Object> parms = new HashMap<String, Object>();
		
		parms.put("P_NGAY_CHAY_MF_FROM", ngayChayMfF);
		parms.put("P_NGAY_CHAY_MF_TO", ngayChayMfT);	
		parms.put("P_ID_TRAM", idTram);	
		parms.put("P_LOAI_NL", loaiNhienLieu);
		parms.put("P_TINH", tinh);
		parms.put("P_TEN_XXH_VTT", tenXhhVtt);
		parms.put("P_TYPE",  type);
		parms.put("P_USERNAME",  username);
		parms.put("P_DATA", null);
			
		return getSqlMapClientTemplate().queryForList("QLDN_TRAM_TT_NHIEN_LIEU.getTramTTNhienLieuList", parms);
	}
}