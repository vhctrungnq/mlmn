<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="S_SUMMARY_LOGS">
  <resultMap class="vn.com.vhc.vmsc2.statistics.domain.SummaryLog" id="ibatorgenerated_BaseResultMap">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Fri Sep 10 17:26:49 ICT 2010.
    -->
    <result column="LOG_TIME" jdbcType="OTHER" property="logTime" />
    <result column="ERROR_CODE" jdbcType="VARCHAR" property="errorCode" />
    <result column="PROCEDURE_NAME" jdbcType="VARCHAR" property="procedureName" />
    <result column="DAY" jdbcType="DATE" property="day" />
    <result column="HOUR" jdbcType="DECIMAL" property="hour" />
    <result column="RESULT" jdbcType="VARCHAR" property="result" />
    <result column="SQL_STATEMENT" jdbcType="VARCHAR" property="sqlStatement" />
  </resultMap>
  <insert id="ibatorgenerated_insert" parameterClass="vn.com.vhc.vmsc2.statistics.domain.SummaryLog">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Fri Sep 10 17:26:49 ICT 2010.
    -->
    insert into S_SUMMARY_LOGS (LOG_TIME, ERROR_CODE, PROCEDURE_NAME, DAY, HOUR, RESULT,
      SQL_STATEMENT)
    values (#logTime:OTHER#, #errorCode:VARCHAR#, #procedureName:VARCHAR#, #day:DATE#,
      #hour:DECIMAL#, #result:VARCHAR#, #sqlStatement:VARCHAR#)
  </insert>
  <insert id="ibatorgenerated_insertSelective" parameterClass="vn.com.vhc.vmsc2.statistics.domain.SummaryLog">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Fri Sep 10 17:26:49 ICT 2010.
    -->
    insert into S_SUMMARY_LOGS
    <dynamic prepend="(">
      <isNotNull prepend="," property="logTime">
        LOG_TIME
      </isNotNull>
      <isNotNull prepend="," property="errorCode">
        ERROR_CODE
      </isNotNull>
      <isNotNull prepend="," property="procedureName">
        PROCEDURE_NAME
      </isNotNull>
      <isNotNull prepend="," property="day">
        DAY
      </isNotNull>
      <isNotNull prepend="," property="hour">
        HOUR
      </isNotNull>
      <isNotNull prepend="," property="result">
        RESULT
      </isNotNull>
      <isNotNull prepend="," property="sqlStatement">
        SQL_STATEMENT
      </isNotNull>
      )
    </dynamic>
    values
    <dynamic prepend="(">
      <isNotNull prepend="," property="logTime">
        #logTime:OTHER#
      </isNotNull>
      <isNotNull prepend="," property="errorCode">
        #errorCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="procedureName">
        #procedureName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="day">
        #day:DATE#
      </isNotNull>
      <isNotNull prepend="," property="hour">
        #hour:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="result">
        #result:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="sqlStatement">
        #sqlStatement:VARCHAR#
      </isNotNull>
      )
    </dynamic>
  </insert>
  
<!--   <select id="filter" parameterClass="vn.com.vhc.vmsc2.statistics.web.filter.SummaryLogFilter" resultMap="ibatorgenerated_BaseResultMap">
    select *
    from ( select a.*, rownum r
	    from (
	    	select *
		    from S_SUMMARY_LOGS
		    <dynamic prepend="where">
		      <isNotEmpty prepend="and" property="startDate">
		        LOG_TIME <![CDATA[ >= ]]> to_date(#startDate#, 'DD/MM/YYYY HH24:mi')
		      </isNotEmpty>
		      <isNotEmpty prepend="and" property="endDate">
		        LOG_TIME <![CDATA[ <= ]]> to_date(#endDate#, 'DD/MM/YYYY HH24:mi')
		      </isNotEmpty>
		      <isNotEmpty prepend="and" property="errorCode" >
		        ERROR_CODE like  '%' || #errorCode:VARCHAR# || '%
		      </isNotEmpty>
		        <isNotEmpty prepend="and" property="procedureName" >
		        PROCEDURE_NAME like  '%' || #procedureName:VARCHAR# || '%
		      </isNotEmpty>
		    </dynamic>
		    order by LOG_TIME desc
		) a
		where rownum <![CDATA[ <= ]]> #endRecord# )
	where r &gt; #startRecord#
  </select> -->
  
  <select id="filter" parameterClass="vn.com.vhc.vmsc2.statistics.web.filter.SummaryLogFilter" resultMap="ibatorgenerated_BaseResultMap">
	    	select *
		    from S_SUMMARY_LOGS
		    <dynamic prepend="where">
		      <isNotEmpty prepend="and" property="startDate">
		        LOG_TIME <![CDATA[ >= ]]> to_date(#startDate#, 'DD/MM/YYYY HH24:mi')
		      </isNotEmpty>
		      <isNotEmpty prepend="and" property="endDate">
		        LOG_TIME <![CDATA[ <= ]]> to_date(#endDate#, 'DD/MM/YYYY HH24:mi')
		      </isNotEmpty>
		      <isNotEmpty prepend="and" property="errorCode" >
		        UPPER(ERROR_CODE) like  '%' || UPPER(#errorCode:VARCHAR#) || '%'
		      </isNotEmpty>
		        <isNotEmpty prepend="and" property="procedureName" >
		        UPPER(PROCEDURE_NAME) like  '%' || UPPER(#procedureName:VARCHAR#) || '%'
		      </isNotEmpty>
		      <isNotEmpty prepend="and" property="result" >
		        UPPER(RESULT) like  '%' || UPPER(#result:VARCHAR#) || '%'
		      </isNotEmpty>
		      <isNotEmpty prepend="and" property="sqlStatement" >
		        UPPER(SQL_STATEMENT) like  '%' || UPPER(#sqlStatement:VARCHAR#) || '%'
		      </isNotEmpty>
		    </dynamic>
		    order by LOG_TIME desc
  </select>
  <select id="countRow" parameterClass="vn.com.vhc.vmsc2.statistics.web.filter.SummaryLogFilter" resultClass="Integer">
    select count(*) from S_SUMMARY_LOGS
		    <dynamic prepend="where">
		      <isNotEmpty prepend="and" property="startDate">
		        LOG_TIME <![CDATA[ >= ]]> to_date(#startDate#, 'DD/MM/YYYY HH24:mi')
		      </isNotEmpty>
		      <isNotEmpty prepend="and" property="endDate">
		        LOG_TIME <![CDATA[ <= ]]> to_date(#endDate#, 'DD/MM/YYYY HH24:mi')
		      </isNotEmpty>
		      <isNotEmpty prepend="and" property="errorCode" >
		        UPPER(ERROR_CODE) like  '%' || UPPER(#errorCode:VARCHAR#) || '%'
		      </isNotEmpty>
		        <isNotEmpty prepend="and" property="procedureName" >
		        UPPER(PROCEDURE_NAME) like  '%' || UPPER(#procedureName:VARCHAR#) || '%'
		      </isNotEmpty>
		      <isNotEmpty prepend="and" property="result" >
		        UPPER(RESULT) like  '%' || UPPER(#result:VARCHAR#) || '%'
		      </isNotEmpty>
		      <isNotEmpty prepend="and" property="sqlStatement" >
		        UPPER(SQL_STATEMENT) like  '%' || UPPER(#sqlStatement:VARCHAR#) || '%'
		      </isNotEmpty>
		    </dynamic>
  </select>
</sqlMap>