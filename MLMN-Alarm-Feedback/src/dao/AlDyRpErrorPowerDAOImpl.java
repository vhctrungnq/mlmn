package dao;

import java.util.HashMap;
import java.util.List;
import java.util.Map;

import org.springframework.orm.ibatis.support.SqlMapClientDaoSupport;
import vo.AlDyRpErrorPower;
import vo.SYS_PARAMETER;
import vo.WarningDipSame;

public class AlDyRpErrorPowerDAOImpl extends SqlMapClientDaoSupport implements AlDyRpErrorPowerDAO {

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table AL_DY_RP_ERROR_POWER
     *
     * @ibatorgenerated Thu May 30 10:31:11 ICT 2013
     */
    public AlDyRpErrorPowerDAOImpl() {
        super();
    }

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table AL_DY_RP_ERROR_POWER
     *
     * @ibatorgenerated Thu May 30 10:31:11 ICT 2013
     */
    public void insert(AlDyRpErrorPower record) {
        getSqlMapClientTemplate().insert("AL_DY_RP_ERROR_POWER.ibatorgenerated_insert", record);
    }

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table AL_DY_RP_ERROR_POWER
     *
     * @ibatorgenerated Thu May 30 10:31:11 ICT 2013
     */
    public void insertSelective(AlDyRpErrorPower record) {
        getSqlMapClientTemplate().insert("AL_DY_RP_ERROR_POWER.ibatorgenerated_insertSelective", record);
    }
    
    @Override
	public int updateByPrimaryKeySelective(AlDyRpErrorPower record) {
		Map<String, Object> map = new HashMap<String, Object>();
		map.put("P_ID", record.getId());
		map.put("P_SDATE", record.getSdate());
		map.put("P_BSCID", record.getBscid());
		map.put("P_SITE", record.getSite());
		map.put("P_TEAM_PROCESS", record.getTeamProcess());
		map.put("P_USER_PROCESS", record.getUserProcess());
		map.put("P_CAUSEBY_CONTENT", record.getCausebyContent());
		map.put("P_RESULT_CONTENT", record.getResultContent());
		map.put("P_SHIFT_ID", record.getShiftId());
		 int rows = getSqlMapClientTemplate().update("AL_DY_RP_ERROR_POWER.update", map);
	        return rows;
	}

	/*@Override
	public int deleteByPrimaryKey(Integer id) {
		VAlDyRpErrorPower key = new VAlDyRpErrorPower();
        key.setId(id);
        int rows = getSqlMapClientTemplate().delete("AL_DY_RP_ERROR_POWER.deleteByPrimaryKey", key);
        return rows;
	}

	@Override
	public VAlDyRpErrorPower selectByPrimaryKey(int id) {
		VAlDyRpErrorPower key = new VAlDyRpErrorPower();
        key.setId(id);
        VAlDyRpErrorPower record = (VAlDyRpErrorPower) getSqlMapClientTemplate().queryForObject("AL_DY_RP_ERROR_POWER.selectByPrimaryKey", key);
        return record;
	}
*/
	 @Override
   	public int deleteByPrimaryKey(Integer id) {
           Map<String, Object> parms = new HashMap<String, Object>();
   		parms.put("P_ID", id);
   		int rows = getSqlMapClientTemplate().delete("AL_DY_RP_ERROR_POWER.deleteByPrimaryKey", parms);
   		return rows;
   	}
   	@SuppressWarnings("unchecked")
   	@Override
   	public AlDyRpErrorPower selectByPrimaryKey(int id) {
   		Map<String, Object> parms = new HashMap<String, Object>();
   		parms.put("P_ID",id);
   		parms.put("P_DATA", null);
   		List<AlDyRpErrorPower> recordList = getSqlMapClientTemplate().queryForList("AL_DY_RP_ERROR_POWER.selectByPrimaryKey", parms);
   		AlDyRpErrorPower record = new AlDyRpErrorPower();
   		if (recordList.size()>0)
   		{
   			record = recordList.get(0);
   		}
           return record;
   	}
	@Override
	public int getStartJobErrorPower(String startTime) {
    	int rows = getSqlMapClientTemplate().update("AL_DY_RP_ERROR_POWER.getStartJobErrorPower", startTime);
        return rows;
	}

	/*@Override
	public List<VAlDyRpErrorPower> getVAlDyRpErrorPowerFilter(String sday,
			String eday, String bscid, String site, String teamProcess,
			int order, String column) {
		Map<String, Object> map = new HashMap<String, Object>();
    	map.put("P_SDAY", sday);
    	map.put("P_EDAY", eday);
    	map.put("P_BSCID", bscid);
    	map.put("P_SITE", site);
    	map.put("P_TEAM_PROCESS", teamProcess);
    	map.put("P_COLUMN", column);
    	map.put("P_ORDER", order);
    	map.put("P_DATA", null);
    return getSqlMapClientTemplate().queryForList("AL_DY_RP_ERROR_POWER.getVAlDyRpErrorPowerFilter", map);
	}*/

	@SuppressWarnings("unchecked")
	@Override
	public List<AlDyRpErrorPower> getVAlDyRpErrorPowerFilter(String sday,
			String eday, String bscid, String site, String teamProcess,
			int order, String column) {
		Map<String, Object> map = new HashMap<String, Object>();
    	map.put("P_SDAY", sday);
    	map.put("P_EDAY", eday);
    	map.put("P_BSCID", bscid);
    	map.put("P_SITE", site);
    	map.put("P_TEAM_PROCESS", teamProcess);
    	map.put("P_COLUMN", column);
    	map.put("P_ORDER", order);
    	map.put("P_DATA", null);
    return getSqlMapClientTemplate().queryForList("AL_DY_RP_ERROR_POWER.getVAlDyRpErrorPowerFilter", map);
	
	}

	@SuppressWarnings("unchecked")
	@Override
	public List<WarningDipSame> getAlarmSameSystem(String bscID, String device,
			String day) {
		Map<String, Object> map = new HashMap<String, Object>();
		map.put("P_BSCID", bscID);
		map.put("P_SITE", device);
		map.put("P_DAY", day);
		map.put("P_DATA", null);
		return getSqlMapClientTemplate().queryForList("AL_DY_RP_ERROR_POWER.getAlarmSameSystem", map);
	}

	@SuppressWarnings("unchecked")
	@Override
	public List<SYS_PARAMETER> titleErrorPower(String typeForm) {
		Map<String, Object> map = new HashMap<String, Object>();
		map.put("P_TYPE_FORM", typeForm);
		map.put("P_DATA", null);
		return getSqlMapClientTemplate().queryForList("AL_DY_RP_ERROR_POWER.titleErrorPower", map);
	}

	@Override
	public int getStartJobErrorPower() {
		int rows = getSqlMapClientTemplate().update("AL_DY_RP_ERROR_POWER.getStartJobErrorPower");
        return rows;
	}
}