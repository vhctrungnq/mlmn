package dao;

import java.util.HashMap;
import java.util.List;
import java.util.Map;

import org.springframework.orm.ibatis.support.SqlMapClientDaoSupport;
import vo.QldnThongTinMayNo;

public class QldnThongTinMayNoDAOImpl extends SqlMapClientDaoSupport implements QldnThongTinMayNoDAO {

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table QLDN_THONG_TIN_MAY_NO
     *
     * @ibatorgenerated Mon Jul 03 14:28:31 ICT 2017
     */
    public QldnThongTinMayNoDAOImpl() {
        super();
    }

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table QLDN_THONG_TIN_MAY_NO
     *
     * @ibatorgenerated Mon Jul 03 14:28:31 ICT 2017
     */
    public int deleteByPrimaryKey(Integer id) {
        QldnThongTinMayNo key = new QldnThongTinMayNo();
        key.setId(id);
        int rows = getSqlMapClientTemplate().delete("QLDN_THONG_TIN_MAY_NO.ibatorgenerated_deleteByPrimaryKey", key);
        return rows;
    }

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table QLDN_THONG_TIN_MAY_NO
     *
     * @ibatorgenerated Mon Jul 03 14:28:31 ICT 2017
     */
    public void insert(QldnThongTinMayNo record) {
        getSqlMapClientTemplate().insert("QLDN_THONG_TIN_MAY_NO.ibatorgenerated_insert", record);
    }

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table QLDN_THONG_TIN_MAY_NO
     *
     * @ibatorgenerated Mon Jul 03 14:28:31 ICT 2017
     */
    public void insertSelective(QldnThongTinMayNo record) {
        getSqlMapClientTemplate().insert("QLDN_THONG_TIN_MAY_NO.ibatorgenerated_insertSelective", record);
    }

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table QLDN_THONG_TIN_MAY_NO
     *
     * @ibatorgenerated Mon Jul 03 14:28:31 ICT 2017
     */
    public QldnThongTinMayNo selectByPrimaryKey(Integer id) {
        QldnThongTinMayNo key = new QldnThongTinMayNo();
        key.setId(id);
        QldnThongTinMayNo record = (QldnThongTinMayNo) getSqlMapClientTemplate().queryForObject("QLDN_THONG_TIN_MAY_NO.ibatorgenerated_selectByPrimaryKey", key);
        return record;
    }

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table QLDN_THONG_TIN_MAY_NO
     *
     * @ibatorgenerated Mon Jul 03 14:28:31 ICT 2017
     */
    public int updateByPrimaryKeySelective(QldnThongTinMayNo record) {
        int rows = getSqlMapClientTemplate().update("QLDN_THONG_TIN_MAY_NO.ibatorgenerated_updateByPrimaryKeySelective", record);
        return rows;
    }

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table QLDN_THONG_TIN_MAY_NO
     *
     * @ibatorgenerated Mon Jul 03 14:28:31 ICT 2017
     */
    public int updateByPrimaryKey(QldnThongTinMayNo record) {
        int rows = getSqlMapClientTemplate().update("QLDN_THONG_TIN_MAY_NO.ibatorgenerated_updateByPrimaryKey", record);
        return rows;
    }
    // kiem tra thong tin may no da ton tai chua
	@Override
	public QldnThongTinMayNo checkThongTinMayNo(String idTram, String idDtxd) {
		 QldnThongTinMayNo key = new QldnThongTinMayNo();
	        key.setIdTram(idTram);
	        key.setIdDtxd(idDtxd);
	        QldnThongTinMayNo record = (QldnThongTinMayNo) getSqlMapClientTemplate().queryForObject("QLDN_THONG_TIN_MAY_NO.checkThongTinMayNo", key);
	        return record;
	}

	@SuppressWarnings("unchecked")
	@Override
	public List<QldnThongTinMayNo> filter(String idTram, String idDtxd, String tinh, String toVt, String nhom,
			String loaiThanhToan, String tenXhhVtt, String hieuMay, String congSuat, String dinhMuc, String ats) {
		// TODO Auto-generated method stub
		Map<String, String> parms = new HashMap<String, String>();
		parms.put("p_id_tram", idTram);
		parms.put("p_id_dtxd", idDtxd);
		parms.put("p_tinh", tinh);
		parms.put("p_to", toVt);
		parms.put("p_nhom", nhom);
		parms.put("p_loai_thanh_toan", loaiThanhToan);
		parms.put("p_ten_xhh", tenXhhVtt);
		parms.put("p_hieu_may", hieuMay);
		parms.put("p_cong_suat", congSuat);
		parms.put("p_dinh_muc", dinhMuc);
		parms.put("p_ats", ats);
		parms.put("p_data", null);
		return getSqlMapClientTemplate().queryForList("QLDN_THONG_TIN_MAY_NO.filter", parms);
	}
	
	@Override
	public int getMaxId() {
	    // TODO Auto-generated method stub
	    return (Integer) getSqlMapClientTemplate().queryForObject("QLDN_THONG_TIN_MAY_NO.getMaxId");
	}
	
	@SuppressWarnings("unchecked")
	@Override
	public List<QldnThongTinMayNo> getThongKeMayNo(String type) {
    	Map<String, String> map = new HashMap<String, String>();
    	map.put("P_TYPE", type);  
		map.put("p_data", null);
		return getSqlMapClientTemplate().queryForList("QLDN_THONG_TIN_MAY_NO.getThongKeMayNo", map);
	}
	
	@SuppressWarnings("unchecked")
	@Override
	public List<QldnThongTinMayNo> getThongTinMayNoList(String idTram, String idDtxd, String loaiThanhToan,
		String tenTram, String tinh, String to, String nhom, String tenXhhVtt, String hieuMayNo,
		String congSuat, String dinhMuc, String loaiNhienLieu, String ats) {
	    Map<String, Object> parms = new HashMap<String, Object>();
	    parms.put("p_idTram", idTram);
	    parms.put("p_idDtxd", idDtxd);
	    parms.put("p_loaiThanhToan", loaiThanhToan);
	    parms.put("p_tenTram", tenTram);
	    parms.put("p_tinh", tinh);
	    parms.put("p_to", to);
	    parms.put("p_nhom", nhom);
	    parms.put("p_tenXhhVtt", tenXhhVtt);
	    parms.put("p_hieuMayNo", hieuMayNo);
	    parms.put("p_congSuat", congSuat);
	    parms.put("p_dinhMuc", dinhMuc);
	    parms.put("p_loaiNhienLieu", loaiNhienLieu);
	    parms.put("p_ats", ats);
	  //  parms.put("p_data", null);
	    	
	    
	    List<QldnThongTinMayNo> record = getSqlMapClientTemplate().queryForList("QLDN_THONG_TIN_MAY_NO.getList", parms);
        return record;
	}
}