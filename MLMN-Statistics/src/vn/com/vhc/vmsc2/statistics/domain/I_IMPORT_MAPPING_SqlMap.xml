<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="I_IMPORT_MAPPING" >
  <resultMap id="ibatorgenerated_BaseResultMap" class="vn.com.vhc.vmsc2.statistics.domain.ImportMapping" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Aug 25 01:37:33 ICT 2010.
    -->
    <result column="PATTERN_ID" property="patternId" jdbcType="DECIMAL" />
    <result column="RAW_TABLE" property="rawTable" jdbcType="VARCHAR" />
    <result column="TABLE_COLUMN" property="tableColumn" jdbcType="VARCHAR" />
    <result column="FILE_PATTERN" property="filePattern" />
    <result column="FILE_COLUMN" property="fileColumn" jdbcType="DECIMAL" />
    <result column="DATA_TYPE" property="dataType" jdbcType="VARCHAR" />
    <result column="DATA_FORMAT" property="dataFormat" jdbcType="VARCHAR" />
    <result column="CREATE_DATE" property="createDate" jdbcType="DATE" />
    <result column="CREATE_BY" property="createBy" jdbcType="VARCHAR" />
    <result column="FILE_COLUMN_HEADER" property="fileColumnHeader" jdbcType="VARCHAR" />
    <result column="STATUS" property="status" jdbcType="VARCHAR" />
  </resultMap>
  <resultMap id="ibatorgenerated_BaseResultMap1" class="vn.com.vhc.vmsc2.statistics.domain.ImportMapping" >
    <result column="PATTERN_ID" property="patternId" jdbcType="DECIMAL" />
    <result column="RAW_TABLE" property="rawTable" jdbcType="VARCHAR" />
    <result column="TABLE_COLUMN" property="tableColumn" jdbcType="VARCHAR" />
    <result column="FILE_PATTERN" property="filePattern" />
    <result column="FILE_COLUMN" property="fileColumn" jdbcType="DECIMAL" />
    <result column="DATA_TYPE" property="dataType" jdbcType="VARCHAR" />
    <result column="DATA_FORMAT" property="dataFormat" jdbcType="VARCHAR" />
    <result column="FILE_COLUMN_HEADER" property="fileColumnHeader" jdbcType="VARCHAR" />
    <result column="TRANG_THAI" property="trangthai" jdbcType="VARCHAR" />
    </resultMap>
  <select id="ibatorgenerated_selectByPrimaryKey" resultMap="ibatorgenerated_BaseResultMap" parameterClass="vn.com.vhc.vmsc2.statistics.domain.ImportMapping" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Aug 25 01:37:33 ICT 2010.
    -->
    select m.*, p.FILE_PATTERN
    from I_IMPORT_MAPPING m, C_FILE_PATTERNS p
    where m.PATTERN_ID = p.PATTERN_ID
      and m.PATTERN_ID = #patternId:DECIMAL#
      and m.RAW_TABLE = #rawTable:VARCHAR#
      and m.TABLE_COLUMN = #tableColumn:VARCHAR#
  </select>
  <delete id="ibatorgenerated_deleteByPrimaryKey" parameterClass="vn.com.vhc.vmsc2.statistics.domain.ImportMapping" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Aug 25 01:37:33 ICT 2010.
    -->
    delete from I_IMPORT_MAPPING
    where PATTERN_ID = #patternId:DECIMAL#
      and RAW_TABLE = #rawTable:VARCHAR#
      and TABLE_COLUMN = #tableColumn:VARCHAR#
  </delete>
  <insert id="ibatorgenerated_insert" parameterClass="vn.com.vhc.vmsc2.statistics.domain.ImportMapping" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Aug 25 01:37:33 ICT 2010.
    -->
    insert into I_IMPORT_MAPPING (PATTERN_ID, RAW_TABLE, TABLE_COLUMN, FILE_COLUMN, DATA_TYPE,
      DATA_FORMAT, CREATE_BY, FILE_COLUMN_HEADER, STATUS)
    values (#patternId:DECIMAL#, #rawTable:VARCHAR#, #tableColumn:VARCHAR#, #fileColumn:DECIMAL#,
      #dataType:VARCHAR#, #dataFormat:VARCHAR#, #createBy:VARCHAR#,
      #fileColumnHeader:VARCHAR#, #status:VARCHAR#)
  </insert>
  <insert id="ibatorgenerated_insertSelective" parameterClass="vn.com.vhc.vmsc2.statistics.domain.ImportMapping" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Aug 25 01:37:33 ICT 2010.
    -->
    insert into I_IMPORT_MAPPING
    <dynamic prepend="(" >
      <isNotNull prepend="," property="patternId" >
        PATTERN_ID
      </isNotNull>
      <isNotNull prepend="," property="rawTable" >
        RAW_TABLE
      </isNotNull>
      <isNotNull prepend="," property="tableColumn" >
        TABLE_COLUMN
      </isNotNull>
      <isNotNull prepend="," property="fileColumn" >
        FILE_COLUMN
      </isNotNull>
      <isNotNull prepend="," property="dataType" >
        DATA_TYPE
      </isNotNull>
      <isNotNull prepend="," property="dataFormat" >
        DATA_FORMAT
      </isNotNull>
      <isNotNull prepend="," property="createBy" >
        CREATE_BY
      </isNotNull>
      <isNotNull prepend="," property="fileColumnHeader" >
        FILE_COLUMN_HEADER
      </isNotNull>
      <isNotNull prepend="," property="status" >
        STATUS
      </isNotNull>
      )
    </dynamic>
    values
    <dynamic prepend="(" >
      <isNotNull prepend="," property="patternId" >
        #patternId:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="rawTable" >
        #rawTable:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="tableColumn" >
        #tableColumn:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="fileColumn" >
        #fileColumn:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="dataType" >
        #dataType:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="dataFormat" >
        #dataFormat:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="createBy" >
        #createBy:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="fileColumnHeader" >
        #fileColumnHeader:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="status" >
        #status:VARCHAR#
      </isNotNull>
      )
    </dynamic>
  </insert>
  <update id="ibatorgenerated_updateByPrimaryKeySelective" parameterClass="vn.com.vhc.vmsc2.statistics.domain.ImportMapping" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Aug 25 01:37:33 ICT 2010.
    -->
    update I_IMPORT_MAPPING
    <dynamic prepend="set" >
      <isNotNull prepend="," property="fileColumn" >
        FILE_COLUMN = #fileColumn:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="dataType" >
        DATA_TYPE = #dataType:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="dataFormat" >
        DATA_FORMAT = #dataFormat:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="createBy" >
        CREATE_BY = #createBy:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="fileColumnHeader" >
        FILE_COLUMN_HEADER = #fileColumnHeader:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="status" >
        STATUS = #status:VARCHAR#
      </isNotNull>
    </dynamic>
    where PATTERN_ID = #patternId:DECIMAL#
      and RAW_TABLE = #rawTable:VARCHAR#
      and TABLE_COLUMN = #tableColumn:VARCHAR#
  </update>
  <update id="ibatorgenerated_updateByPrimaryKey" parameterClass="vn.com.vhc.vmsc2.statistics.domain.ImportMapping" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Aug 25 01:37:33 ICT 2010.
    -->
    update I_IMPORT_MAPPING
    set FILE_COLUMN = #fileColumn:DECIMAL#,
      DATA_TYPE = #dataType:VARCHAR#,
      DATA_FORMAT = #dataFormat:VARCHAR#,
      CREATE_BY = #createBy:VARCHAR#,
      FILE_COLUMN_HEADER = #fileColumnHeader:VARCHAR#,
      STATUS = #status:VARCHAR#
    where PATTERN_ID = #patternId:DECIMAL#
      and RAW_TABLE = #rawTable:VARCHAR#
      and TABLE_COLUMN = #tableColumn:VARCHAR#
  </update>
  
  <select id="getAll" resultMap="ibatorgenerated_BaseResultMap">
	select m.*, p.FILE_PATTERN, t.TRANG_THAI
    from I_IMPORT_MAPPING m, C_FILE_PATTERNS p, SYS_PARAMETERS t
    where m.PATTERN_ID = p.PATTERN_ID
    and	  m.STATUS = t.MA_TT
  </select>
  
  <select id="filter" resultMap="ibatorgenerated_BaseResultMap1" parameterClass="vn.com.vhc.vmsc2.statistics.web.filter.ImportMappingFilter" >
    select m.PATTERN_ID,m.RAW_TABLE,m.FILE_COLUMN,m.DATA_TYPE,TABLE_COLUMN,m.DATA_FORMAT,
    	   m.FILE_COLUMN_HEADER, p.FILE_PATTERN,t.TRANG_THAI
    from I_IMPORT_MAPPING m, C_FILE_PATTERNS p, SYS_PARAMETERS t
    where m.PATTERN_ID = p.PATTERN_ID
     and	m.STATUS = t.Ma_TT
    <dynamic prepend="and" >
      <isNotEmpty prepend="and" property="filePattern" >
        UPPER(p.FILE_PATTERN) like '%' || UPPER(#filePattern:VARCHAR#) || '%'
      </isNotEmpty>
      <isNotEmpty prepend="and" property="rawTable" >
        UPPER(m.RAW_TABLE) like '%' || UPPER(#rawTable:VARCHAR#) || '%'
      </isNotEmpty>
      <isNotEmpty prepend="and" property="status" >
        m.STATUS = #status:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="and" property="tableColumn">
        UPPER(m.TABLE_COLUMN) like '%' ||UPPER(#tableColumn:VARCHAR#)|| '%'
      </isNotEmpty>
      <isNotEmpty prepend="and" property="fileColumnHeader">
        UPPER(m.FILE_COLUMN_HEADER) like '%' ||UPPER(#fileColumnHeader:VARCHAR#)|| '%'
      </isNotEmpty>
    </dynamic>
    order by UPPER(m.RAW_TABLE) asc
  </select>
  
   <select id="exitsFilePattern" resultMap="ibatorgenerated_BaseResultMap" parameterClass="vn.com.vhc.vmsc2.statistics.domain.ImportMapping" >
    select *
    from I_IMPORT_MAPPING
    where RAW_TABLE = #rawTable:VARCHAR#
    and	  TABLE_COLUMN = #tableColumn:VARCHAR#
   	order by UPPER(RAW_TABLE) asc
  </select>
</sqlMap>
