package dao;

import java.util.HashMap;
import java.util.List;
import java.util.Map;

import org.springframework.orm.ibatis.support.SqlMapClientDaoSupport;
import vo.DyReportLosspowerByTeam;
import vo.SYS_PARAMETER;

public class DyReportLosspowerByTeamDAOImpl extends SqlMapClientDaoSupport implements DyReportLosspowerByTeamDAO {

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table DY_REPORT_LOSSPOWER_BY_TEAM
     *
     * @ibatorgenerated Sat Dec 01 10:51:22 ICT 2012
     */
    public DyReportLosspowerByTeamDAOImpl() {
        super();
    }

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table DY_REPORT_LOSSPOWER_BY_TEAM
     *
     * @ibatorgenerated Sat Dec 01 10:51:22 ICT 2012
     */
    public int deleteByPrimaryKey(Integer id) {
        DyReportLosspowerByTeam key = new DyReportLosspowerByTeam();
        key.setId(id);
        int rows = getSqlMapClientTemplate().delete("DY_REPORT_LOSSPOWER_BY_TEAM.ibatorgenerated_deleteByPrimaryKey", key);
        return rows;
    }

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table DY_REPORT_LOSSPOWER_BY_TEAM
     *
     * @ibatorgenerated Sat Dec 01 10:51:22 ICT 2012
     */
    public void insert(DyReportLosspowerByTeam record) {
        getSqlMapClientTemplate().insert("DY_REPORT_LOSSPOWER_BY_TEAM.ibatorgenerated_insert", record);
    }

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table DY_REPORT_LOSSPOWER_BY_TEAM
     *
     * @ibatorgenerated Sat Dec 01 10:51:22 ICT 2012
     */
    public void insertSelective(DyReportLosspowerByTeam record) {
        getSqlMapClientTemplate().insert("DY_REPORT_LOSSPOWER_BY_TEAM.ibatorgenerated_insertSelective", record);
    }

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table DY_REPORT_LOSSPOWER_BY_TEAM
     *
     * @ibatorgenerated Sat Dec 01 10:51:22 ICT 2012
     */
    public DyReportLosspowerByTeam selectByPrimaryKey(Integer id) {
        DyReportLosspowerByTeam key = new DyReportLosspowerByTeam();
        key.setId(id);
        DyReportLosspowerByTeam record = (DyReportLosspowerByTeam) getSqlMapClientTemplate().queryForObject("DY_REPORT_LOSSPOWER_BY_TEAM.ibatorgenerated_selectByPrimaryKey", key);
        return record;
    }

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table DY_REPORT_LOSSPOWER_BY_TEAM
     *
     * @ibatorgenerated Sat Dec 01 10:51:22 ICT 2012
     */
    public int updateByPrimaryKeySelective(DyReportLosspowerByTeam record) {
        int rows = getSqlMapClientTemplate().update("DY_REPORT_LOSSPOWER_BY_TEAM.ibatorgenerated_updateByPrimaryKeySelective", record);
        return rows;
    }

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table DY_REPORT_LOSSPOWER_BY_TEAM
     *
     * @ibatorgenerated Sat Dec 01 10:51:22 ICT 2012
     */
    public int updateByPrimaryKey(DyReportLosspowerByTeam record) {
        int rows = getSqlMapClientTemplate().update("DY_REPORT_LOSSPOWER_BY_TEAM.ibatorgenerated_updateByPrimaryKey", record);
        return rows;
    }

	@SuppressWarnings("unchecked")
	@Override
	public List<DyReportLosspowerByTeam> createReportWithTeam(String startTime,
			String endTime) {
		Map<String, Object> map = new HashMap<String, Object>();
		
		map.put("P_START_DATE", startTime);
		map.put("P_END_DATE", endTime);
		map.put("P_DATA", null);
		return getSqlMapClientTemplate().queryForList("DY_REPORT_LOSSPOWER_BY_TEAM.createReportWithTeam", map);
	}

	@Override
	public int getCountAllLoss(String startTime, String endTime) {    	
    	Map<String, Object> parms = new HashMap<String, Object>();
    	parms.put("P_START_DATE", startTime);
		parms.put("P_END_DATE", endTime);
		parms.put("P_DATA", null);
    	getSqlMapClientTemplate().queryForObject("DY_REPORT_LOSSPOWER_BY_TEAM.getCountAllLoss", parms);
    	Integer record = (Integer) parms.get("P_DATA");
    	return record;
	}

	@SuppressWarnings("unchecked")
	@Override
	public List<SYS_PARAMETER> titleReportLossPowerByTeam() {
		Map<String, Object> map = new HashMap<String, Object>();
		map.put("P_DATA", null);
		return getSqlMapClientTemplate().queryForList("DY_REPORT_LOSSPOWER_BY_DAY.titleReportLossPowerByTeam", map);
	}
}