<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="V_RP_DY_HLR_FOR_MGW">
  <resultMap class="vn.com.vhc.vmsc2.statistics.domain.VRpDyHlrForMgw" id="ibatorgenerated_BaseResultMap">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Fri May 10 13:44:29 ICT 2013.
    -->
    <result column="DAY" jdbcType="TIMESTAMP" property="day" />
    <result column="NODEID" jdbcType="VARCHAR" property="nodeid" />
    <result column="MAX_OCCUPIED_RATE_OF_CPU" jdbcType="DECIMAL" property="maxOccupiedRateOfCpu" />
    <result column="USAGE_FLOW" jdbcType="DECIMAL" property="usageFlow" />
    <result column="IP_FLOW" jdbcType="DECIMAL" property="ipFlow" />
  </resultMap>
  <insert id="ibatorgenerated_insert" parameterClass="vn.com.vhc.vmsc2.statistics.domain.VRpDyHlrForMgw">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Fri May 10 13:44:29 ICT 2013.
    -->
    insert into V_RP_DY_HLR_FOR_MGW (DAY, NODEID, MAX_OCCUPIED_RATE_OF_CPU, USAGE_FLOW, IP_FLOW)
    values (#day:TIMESTAMP#, #nodeid:VARCHAR#, #maxOccupiedRateOfCpu:DECIMAL#, #usageFlow:DECIMAL#,
      #ipFlow:DECIMAL#)
  </insert>
  <insert id="ibatorgenerated_insertSelective" parameterClass="vn.com.vhc.vmsc2.statistics.domain.VRpDyHlrForMgw">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Fri May 10 13:44:29 ICT 2013.
    -->
    insert into V_RP_DY_HLR_FOR_MGW
    <dynamic prepend="(">
      <isNotNull prepend="," property="day">
        DAY
      </isNotNull>
      <isNotNull prepend="," property="nodeid">
        NODEID
      </isNotNull>
      <isNotNull prepend="," property="maxOccupiedRateOfCpu">
        MAX_OCCUPIED_RATE_OF_CPU
      </isNotNull>
      <isNotNull prepend="," property="usageFlow">
        USAGE_FLOW
      </isNotNull>
      <isNotNull prepend="," property="ipFlow">
        IP_FLOW
      </isNotNull>
      )
    </dynamic>
    values
    <dynamic prepend="(">
      <isNotNull prepend="," property="day">
        #day:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="nodeid">
        #nodeid:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="maxOccupiedRateOfCpu">
        #maxOccupiedRateOfCpu:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="usageFlow">
        #usageFlow:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="ipFlow">
        #ipFlow:DECIMAL#
      </isNotNull>
      )
    </dynamic>
  </insert>
  <parameterMap id="filter" class="java.util.Map">
    <parameter property="startDate"/>
    <parameter property="endDate"/>
    <parameter property="nodeid" />
  </parameterMap>
  <select id="filter" resultMap="ibatorgenerated_BaseResultMap" parameterMap="filter">
    select *
    from V_RP_DY_HLR_FOR_MGW
    <dynamic prepend="where" >
      <isNotEmpty prepend="and" property="startDate">
        DAY <![CDATA[ >= ]]> to_date(#startDate#, 'DD/MM/YYYY')
      </isNotEmpty>
      <isNotEmpty prepend="and" property="endDate">
        DAY <![CDATA[ <= ]]> to_date(#endDate#, 'DD/MM/YYYY')
      </isNotEmpty>
      <isNotEmpty prepend="and" property="nodeid">
        NODEID like '%' || UPPER(#nodeid:VARCHAR#) || '%'
      </isNotEmpty>
    </dynamic>
    order by NODEID, DAY asc
    </select>
    <parameterMap class="java.util.Map" id="filter1">
    <parameter property="startDate" />
    <parameter property="endDate" />
  </parameterMap>
   <resultMap class="vn.com.vhc.vmsc2.statistics.domain.VRpDyHlrForMgw" id="daylist">
   		<result column="DAY" property="day" jdbcType="DATE" />
  </resultMap>
  <select id="filterDay" parameterMap="filter1" resultMap="daylist">
    select distinct(DAY) From V_RP_DY_HLR_FOR_MGW
    <dynamic prepend="where">
       <isNotEmpty prepend="and" property="startDate">
        DAY <![CDATA[ >= ]]> to_date(#startDate#, 'DD/MM/YYYY')
      </isNotEmpty>
      <isNotEmpty prepend="and" property="endDate">
        DAY <![CDATA[ <= ]]> to_date(#endDate#, 'DD/MM/YYYY')
      </isNotEmpty>
    </dynamic>
	Order by DAY
  </select>
</sqlMap>