package dao;

import java.util.HashMap;
import java.util.List;
import java.util.Map;

import org.springframework.orm.ibatis.support.SqlMapClientDaoSupport;

import vo.SYS_PARAMETER;
import vo.SysMailParameterMaster;

public class SysMailParameterMasterDAOImpl extends SqlMapClientDaoSupport implements SysMailParameterMasterDAO {

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table SYS_MAIL_PARAMETER_MASTER
     *
     * @ibatorgenerated Thu Nov 21 17:25:34 ICT 2013
     */
    public SysMailParameterMasterDAOImpl() {
        super();
    }

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table SYS_MAIL_PARAMETER_MASTER
     *
     * @ibatorgenerated Thu Nov 21 17:25:34 ICT 2013
     */
    public int deleteByPrimaryKey(Integer id) {
        SysMailParameterMaster key = new SysMailParameterMaster();
        key.setId(id);
        int rows = getSqlMapClientTemplate().delete("SYS_MAIL_PARAMETER_MASTER.ibatorgenerated_deleteByPrimaryKey", key);
        return rows;
    }

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table SYS_MAIL_PARAMETER_MASTER
     *
     * @ibatorgenerated Thu Nov 21 17:25:34 ICT 2013
     */
    public void insert(SysMailParameterMaster record) {
        getSqlMapClientTemplate().insert("SYS_MAIL_PARAMETER_MASTER.ibatorgenerated_insert", record);
    }

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table SYS_MAIL_PARAMETER_MASTER
     *
     * @ibatorgenerated Thu Nov 21 17:25:34 ICT 2013
     */
    public void insertSelective(SysMailParameterMaster record) {
        getSqlMapClientTemplate().insert("SYS_MAIL_PARAMETER_MASTER.ibatorgenerated_insertSelective", record);
    }

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table SYS_MAIL_PARAMETER_MASTER
     *
     * @ibatorgenerated Thu Nov 21 17:25:34 ICT 2013
     */
    public SysMailParameterMaster selectByPrimaryKey(Integer id) {
        SysMailParameterMaster key = new SysMailParameterMaster();
        key.setId(id);
        SysMailParameterMaster record = (SysMailParameterMaster) getSqlMapClientTemplate().queryForObject("SYS_MAIL_PARAMETER_MASTER.ibatorgenerated_selectByPrimaryKey", key);
        return record;
    }

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table SYS_MAIL_PARAMETER_MASTER
     *
     * @ibatorgenerated Thu Nov 21 17:25:34 ICT 2013
     */
    public int updateByPrimaryKeySelective(SysMailParameterMaster record) {
        int rows = getSqlMapClientTemplate().update("SYS_MAIL_PARAMETER_MASTER.ibatorgenerated_updateByPrimaryKeySelective", record);
        return rows;
    }

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table SYS_MAIL_PARAMETER_MASTER
     *
     * @ibatorgenerated Thu Nov 21 17:25:34 ICT 2013
     */
    public int updateByPrimaryKey(SysMailParameterMaster record) {
        int rows = getSqlMapClientTemplate().update("SYS_MAIL_PARAMETER_MASTER.ibatorgenerated_updateByPrimaryKey", record);
        return rows;
    }
    
    @SuppressWarnings("unchecked")
	@Override
	public List<SYS_PARAMETER> titleForm(String typeForm) {
		Map<String, Object> parms = new HashMap<String, Object>();
		parms.put("P_FORM", typeForm);	
		parms.put("P_DATA", null);	
		return getSqlMapClientTemplate().queryForList("SYS_MAIL_PARAMETER_MASTER.titleForm", parms);
	}
	 @SuppressWarnings("unchecked")
	@Override
	public List<SysMailParameterMaster> getMailParameterMasterListAll(String mailLevel,String mailID) {
		Map<String, Object> parms = new HashMap<String, Object>();
		parms.put("P_TYPE_MAIL", mailLevel);	 
		parms.put("P_MAIL_ID", mailID);	 
		parms.put("P_DATA", null);	
		return getSqlMapClientTemplate().queryForList("SYS_MAIL_PARAMETER_MASTER.getMailParameterMasterListAll", parms);
	}
/* Tao thong tin gui mail tu dong cho cac chuc nang
 * @Email: Nhom nhan mail
 * @content: Noi dung header can gui trong mail
 * @pathweb: Duong dan chuc nang.
 * */
	@Override
	public int updateMailParameterMaster(String email, String contentHeader,String contentFooter,
			String pathweb) {
		Map<String, Object> parms = new HashMap<String, Object>();
   		parms.put("P_EMAIL", email);
       	parms.put("P_CONTENT_HEADER", contentHeader);
       	parms.put("P_CONTENT_FOOTER", contentFooter);
   		parms.put("P_PATH_WEB", pathweb);
   		 int rows = getSqlMapClientTemplate().update("SYS_MAIL_PARAMETER_MASTER.updateMailParameterMaster", parms);
       return rows;

	}

	@SuppressWarnings("unchecked")
	@Override
	public SysMailParameterMaster getInformationMail(String pathweb) {
		Map<String, Object> parms = new HashMap<String, Object>();
		parms.put("P_PATH_WEB", pathweb);
		parms.put("P_DATA", null);	
		List<SysMailParameterMaster> recordList = getSqlMapClientTemplate().queryForList("SYS_MAIL_PARAMETER_MASTER.getInformationMail", parms);
		SysMailParameterMaster record = new SysMailParameterMaster();
		if (recordList.size()>0)
		{
			record  = recordList.get(0);
		}
		return record;
	}
}