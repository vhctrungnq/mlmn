package vn.com.vhc.vmsc2.statistics.dao;

import java.util.HashMap;
import java.util.List;
import java.util.Map;

import org.springframework.orm.ibatis.support.SqlMapClientDaoSupport;

import vn.com.vhc.vmsc2.statistics.domain.TableConfig;

public class TableConfigDAOImpl extends SqlMapClientDaoSupport implements TableConfigDAO {

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table TABLE_CONFIG
     *
     * @ibatorgenerated Tue Sep 03 11:25:45 ICT 2013
     */
    public TableConfigDAOImpl() {
        super();
    }

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table TABLE_CONFIG
     *
     * @ibatorgenerated Tue Sep 03 11:25:45 ICT 2013
     */
    public int deleteByPrimaryKey(Integer id) {
        TableConfig key = new TableConfig();
        key.setId(id);
        int rows = getSqlMapClientTemplate().delete("TABLE_CONFIG.ibatorgenerated_deleteByPrimaryKey", key);
        return rows;
    }

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table TABLE_CONFIG
     *
     * @ibatorgenerated Tue Sep 03 11:25:45 ICT 2013
     */
    public void insert(TableConfig record) {
        getSqlMapClientTemplate().insert("TABLE_CONFIG.ibatorgenerated_insert", record);
    }

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table TABLE_CONFIG
     *
     * @ibatorgenerated Tue Sep 03 11:25:45 ICT 2013
     */
    public void insertSelective(TableConfig record) {
        getSqlMapClientTemplate().insert("TABLE_CONFIG.ibatorgenerated_insertSelective", record);
    }

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table TABLE_CONFIG
     *
     * @ibatorgenerated Tue Sep 03 11:25:45 ICT 2013
     */
    public TableConfig selectByPrimaryKey(Integer id) {
        TableConfig key = new TableConfig();
        key.setId(id);
        TableConfig record = (TableConfig) getSqlMapClientTemplate().queryForObject("TABLE_CONFIG.ibatorgenerated_selectByPrimaryKey", key);
        return record;
    }

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table TABLE_CONFIG
     *
     * @ibatorgenerated Tue Sep 03 11:25:45 ICT 2013
     */
    public int updateByPrimaryKeySelective(TableConfig record) {
        int rows = getSqlMapClientTemplate().update("TABLE_CONFIG.ibatorgenerated_updateByPrimaryKeySelective", record);
        return rows;
    }

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table TABLE_CONFIG
     *
     * @ibatorgenerated Tue Sep 03 11:25:45 ICT 2013
     */
    public int updateByPrimaryKey(TableConfig record) {
        int rows = getSqlMapClientTemplate().update("TABLE_CONFIG.ibatorgenerated_updateByPrimaryKey", record);
        return rows;
    }
    
    public List<TableConfig> getTableConfigsForGrid(String tableGerneral, String tableName) {
		Map<String, Object> parms = new HashMap<String, Object>();
    	parms.put("P_TABLE_NAME", 		tableName);
    	parms.put("P_TABLE_GENERAL", 		tableGerneral);
    	parms.put("P_DATA", 				null);
    	
		@SuppressWarnings("unchecked")
		List<TableConfig> record = getSqlMapClientTemplate().queryForList("TABLE_CONFIG.getTableConfigsForGrid", parms);
        return record;
	}

	public List<TableConfig> getColumnList(String tableName, String columnName) {
		Map<String, Object> parms = new HashMap<String, Object>();
    	parms.put("P_TABLE_NAME", 		tableName);
    	parms.put("P_COLUMN_NAME", 		columnName);
    	parms.put("P_DATA", 				null);
    	
		@SuppressWarnings("unchecked")
		List<TableConfig> record = getSqlMapClientTemplate().queryForList("TABLE_CONFIG.getColumnList", parms);
        return record;
	}
}