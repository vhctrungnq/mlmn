<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="V_RP_WK_CELL_CAPACITY" >
  <resultMap id="ibatorgenerated_BaseResultMap" class="vn.com.vhc.vmsc2.statistics.domain.VRpWkCellCapacity" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Mon Nov 15 14:24:28 ICT 2010.
    -->
    <result column="WEEK" property="week" jdbcType="DECIMAL" />
    <result column="YEAR" property="year" jdbcType="DECIMAL" />
    <result column="REGION" property="region" jdbcType="VARCHAR" />
    <result column="PROVINCE" property="province" jdbcType="VARCHAR" />
    <result column="DISTRICT" property="district" jdbcType="VARCHAR" />
    <result column="LOCATION" property="location" jdbcType="VARCHAR" />
    <result column="MSCID" property="mscid" jdbcType="VARCHAR" />
    <result column="BSCID" property="bscid" jdbcType="VARCHAR" />
    <result column="CELLID" property="cellid" jdbcType="VARCHAR" />
    <result column="CELLNAME" property="cellname" jdbcType="VARCHAR" />
    <result column="CGI" property="cgi" jdbcType="VARCHAR" />
    <result column="T_AVAIL" property="tAvail" jdbcType="DECIMAL" />
    <result column="T_TRAF" property="tTraf" jdbcType="DECIMAL" />
    <result column="T_TRAFH" property="tTrafh" jdbcType="DECIMAL" />
    <result column="T_GOS" property="tGos" jdbcType="DECIMAL" />
    <result column="T_CAP" property="tCap" jdbcType="DECIMAL" />
    <result column="T_OTRAF" property="tOtraf" jdbcType="DECIMAL" />
    <result column="T_UTIL" property="tUtil" jdbcType="DECIMAL" />
    <result column="T_BLKR" property="tBlkr" jdbcType="DECIMAL" />
    <result column="TCH_VAR" property="tchVar" jdbcType="DECIMAL" />
    <result column="TRX_VAR" property="trxVar" jdbcType="DECIMAL" />
    <result column="TCHREQ" property="tchreq" jdbcType="DECIMAL" />
  </resultMap>
  <insert id="ibatorgenerated_insert" parameterClass="vn.com.vhc.vmsc2.statistics.domain.VRpWkCellCapacity" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Mon Nov 15 14:24:28 ICT 2010.
    -->
    insert into V_RP_WK_CELL_CAPACITY (WEEK, YEAR, REGION, PROVINCE, DISTRICT, LOCATION, MSCID,
      BSCID, CELLID, CELLNAME, CGI, T_AVAIL, T_TRAF, T_TRAFH, T_GOS, T_CAP, T_OTRAF, T_UTIL, T_BLKR,
      TCH_VAR, TRX_VAR, TCHREQ)
    values (#week:DECIMAL#, #year:DECIMAL#, #region:VARCHAR#, #province:VARCHAR#,
      #district:VARCHAR#, #location:VARCHAR#, #mscid:VARCHAR#, #bscid:VARCHAR#, #cellid:VARCHAR#,
      #cellname:VARCHAR#, #cgi:VARCHAR#, #tAvail:DECIMAL#, #tTraf:DECIMAL#, #tTrafh:DECIMAL#,
      #tGos:DECIMAL#, #tCap:DECIMAL#, #tOtraf:DECIMAL#, #tUtil:DECIMAL#, #tBlkr:DECIMAL#,
      #tchVar:DECIMAL#, #trxVar:DECIMAL#, #tchreq:DECIMAL#)
  </insert>
  <insert id="ibatorgenerated_insertSelective" parameterClass="vn.com.vhc.vmsc2.statistics.domain.VRpWkCellCapacity" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Mon Nov 15 14:24:28 ICT 2010.
    -->
    insert into V_RP_WK_CELL_CAPACITY
    <dynamic prepend="(" >
      <isNotNull prepend="," property="week" >
        WEEK
      </isNotNull>
      <isNotNull prepend="," property="year" >
        YEAR
      </isNotNull>
      <isNotNull prepend="," property="region" >
        REGION
      </isNotNull>
      <isNotNull prepend="," property="province" >
        PROVINCE
      </isNotNull>
      <isNotNull prepend="," property="district" >
        DISTRICT
      </isNotNull>
      <isNotNull prepend="," property="location" >
        LOCATION
      </isNotNull>
      <isNotNull prepend="," property="mscid" >
        MSCID
      </isNotNull>
      <isNotNull prepend="," property="bscid" >
        BSCID
      </isNotNull>
      <isNotNull prepend="," property="cellid" >
        CELLID
      </isNotNull>
      <isNotNull prepend="," property="cellname" >
        CELLNAME
      </isNotNull>
      <isNotNull prepend="," property="cgi" >
        CGI
      </isNotNull>
      <isNotNull prepend="," property="tAvail" >
        T_AVAIL
      </isNotNull>
      <isNotNull prepend="," property="tTraf" >
        T_TRAF
      </isNotNull>
      <isNotNull prepend="," property="tTrafh" >
        T_TRAFH
      </isNotNull>
      <isNotNull prepend="," property="tGos" >
        T_GOS
      </isNotNull>
      <isNotNull prepend="," property="tCap" >
        T_CAP
      </isNotNull>
      <isNotNull prepend="," property="tOtraf" >
        T_OTRAF
      </isNotNull>
      <isNotNull prepend="," property="tUtil" >
        T_UTIL
      </isNotNull>
      <isNotNull prepend="," property="tBlkr" >
        T_BLKR
      </isNotNull>
      <isNotNull prepend="," property="tchVar" >
        TCH_VAR
      </isNotNull>
      <isNotNull prepend="," property="trxVar" >
        TRX_VAR
      </isNotNull>
      <isNotNull prepend="," property="tchreq" >
        TCHREQ
      </isNotNull>
      )
    </dynamic>
    values
    <dynamic prepend="(" >
      <isNotNull prepend="," property="week" >
        #week:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="year" >
        #year:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="region" >
        #region:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="province" >
        #province:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="district" >
        #district:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="location" >
        #location:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="mscid" >
        #mscid:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="bscid" >
        #bscid:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="cellid" >
        #cellid:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="cellname" >
        #cellname:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="cgi" >
        #cgi:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="tAvail" >
        #tAvail:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="tTraf" >
        #tTraf:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="tTrafh" >
        #tTrafh:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="tGos" >
        #tGos:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="tCap" >
        #tCap:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="tOtraf" >
        #tOtraf:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="tUtil" >
        #tUtil:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="tBlkr" >
        #tBlkr:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="tchVar" >
        #tchVar:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="trxVar" >
        #trxVar:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="tchreq" >
        #tchreq:DECIMAL#
      </isNotNull>
      )
    </dynamic>
  </insert>
  
   <parameterMap class="java.util.Map" id="filter1-wk-cell-1">
    <parameter property="cellid" />
    <parameter property="bscid" />
    <parameter property="province" />
    <parameter property="startYear" />
    <parameter property="startWeek" />
    <parameter property="endYear" />
    <parameter property="endWeek" />
    <parameter property="region" />
  </parameterMap>
  
  <select id="filter3" parameterMap="filter1-wk-cell-1"  resultMap="ibatorgenerated_BaseResultMap" >
    select *
    from V_RP_WK_CELL_CAPACITY
		    <dynamic prepend="where">
		      <isNotEmpty prepend="and" property="cellid">
		        UPPER(CELLID) like '%' || UPPER(#cellid:VARCHAR#) || '%'
		      </isNotEmpty>
		      <isNotEmpty prepend="and" property="bscid">
		        UPPER(BSCID) = UPPER(#bscid:VARCHAR#)
		      </isNotEmpty>
		      <isNotEmpty prepend="and" property="province">
		        PROVINCE = #province:VARCHAR#
		      </isNotEmpty>
      		<isNotEmpty prepend="and" property="startYear">
        		to_date('1/JAN/'||YEAR,'dd/MM/yyyy') + WEEK*7 -7 BETWEEN (to_date('1/JAN/'||#startYear#,'dd/MM/yyyy') 
      		</isNotEmpty>
      		<isNotEmpty property="startWeek">
        		+#startWeek#*7-7)
      		</isNotEmpty>
      		<isNotEmpty prepend="and" property="endYear">
        		(to_date('1/JAN/'||#endYear#,'dd/MM/yyyy')
      		</isNotEmpty>
      		<isNotEmpty property="endWeek">
      			+#endWeek#*7-7)
      		</isNotEmpty>
		      <isNotEmpty prepend="and" property="region">
		        REGION = #region:VARCHAR#
		      </isNotEmpty>
		    </dynamic>
		    ORDER BY YEAR, WEEK, REGION, PROVINCE, BSCID, CELLID
  </select>
</sqlMap>