package dao;

import java.util.HashMap;
import java.util.List;
import java.util.Map;

import org.springframework.orm.ibatis.support.SqlMapClientDaoSupport;
import vo.QldnDonViThuHuong;
import vo.RAlarmLog;

public class QldnDonViThuHuongDAOImpl extends SqlMapClientDaoSupport implements QldnDonViThuHuongDAO {

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table QLDN_DON_VI_THU_HUONG
     *
     * @ibatorgenerated Mon Jul 03 14:27:39 ICT 2017
     */
    public QldnDonViThuHuongDAOImpl() {
        super();
    }

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table QLDN_DON_VI_THU_HUONG
     *
     * @ibatorgenerated Mon Jul 03 14:27:39 ICT 2017
     */
    public int deleteByPrimaryKey(Integer id) {
        QldnDonViThuHuong key = new QldnDonViThuHuong();
        key.setId(id);
        int rows = getSqlMapClientTemplate().delete("QLDN_DON_VI_THU_HUONG.ibatorgenerated_deleteByPrimaryKey", key);
        return rows;
    }

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table QLDN_DON_VI_THU_HUONG
     *
     * @ibatorgenerated Mon Jul 03 14:27:39 ICT 2017
     */
    public void insert(QldnDonViThuHuong record) {
        getSqlMapClientTemplate().insert("QLDN_DON_VI_THU_HUONG.ibatorgenerated_insert", record);
    }

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table QLDN_DON_VI_THU_HUONG
     *
     * @ibatorgenerated Mon Jul 03 14:27:39 ICT 2017
     */
    public void insertSelective(QldnDonViThuHuong record) {
        getSqlMapClientTemplate().insert("QLDN_DON_VI_THU_HUONG.ibatorgenerated_insertSelective", record);
    }

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table QLDN_DON_VI_THU_HUONG
     *
     * @ibatorgenerated Mon Jul 03 14:27:39 ICT 2017
     */
    public QldnDonViThuHuong selectByPrimaryKey(Integer id) {
        QldnDonViThuHuong key = new QldnDonViThuHuong();
        key.setId(id);
        QldnDonViThuHuong record = (QldnDonViThuHuong) getSqlMapClientTemplate().queryForObject("QLDN_DON_VI_THU_HUONG.ibatorgenerated_selectByPrimaryKey", key);
        return record;
    }

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table QLDN_DON_VI_THU_HUONG
     *
     * @ibatorgenerated Mon Jul 03 14:27:39 ICT 2017
     */
    public int updateByPrimaryKeySelective(QldnDonViThuHuong record) {
        int rows = getSqlMapClientTemplate().update("QLDN_DON_VI_THU_HUONG.ibatorgenerated_updateByPrimaryKeySelective", record);
        return rows;
    }

    /**
     * This method was generated by Apache iBATIS ibator.
     * This method corresponds to the database table QLDN_DON_VI_THU_HUONG
     *
     * @ibatorgenerated Mon Jul 03 14:27:39 ICT 2017
     */
    public int updateByPrimaryKey(QldnDonViThuHuong record) {
        int rows = getSqlMapClientTemplate().update("QLDN_DON_VI_THU_HUONG.ibatorgenerated_updateByPrimaryKey", record);
        return rows;
    }
 // kiem tra don vi thu huong da ton tai chua
	@Override
	public QldnDonViThuHuong checkDVThuHuong(String tenDv) {
		 QldnDonViThuHuong key = new QldnDonViThuHuong();
        key.setTenDv(tenDv);
        QldnDonViThuHuong record = (QldnDonViThuHuong) getSqlMapClientTemplate().queryForObject("QLDN_DON_VI_THU_HUONG.checkDVThuHuong", key);
        return record;
	}
	
	//lay danh sach don vi thu huong
	@SuppressWarnings("unchecked")
	@Override
	public List<QldnDonViThuHuong> getDonViThuHuong() {
		
		return getSqlMapClientTemplate().queryForList("QLDN_DON_VI_THU_HUONG.getDonViThuHuong");

	}
	
	@SuppressWarnings("unchecked")
	@Override
	public List<QldnDonViThuHuong> getList(String tenDv, String maSoThue, String soTaiKhoan, String tenNganHang,
		String ghiChu) {
	    Map<String, Object> parms = new HashMap<String, Object>();
	    parms.put("p_ten_don_vi", tenDv);
	    parms.put("p_ma_so_thue", maSoThue);
	    parms.put("p_so_tai_khoan", soTaiKhoan);
	    parms.put("p_ten_ngan_hang", tenNganHang);
	    parms.put("p_ghi_chu", ghiChu);
	    parms.put("p_data", null);
	    List<QldnDonViThuHuong> record = getSqlMapClientTemplate().queryForList("QLDN_DON_VI_THU_HUONG.getList", parms);
	 return record;
	 
	   
	}
	
}