<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="C_FILE_PATTERNS">
  <cacheModel id="file-pattern-cache" type ="LRU" readOnly="true" serialize="false">
	  <flushInterval hours="24"/>
	  <flushOnExecute statement="C_FILE_PATTERNS.ibatorgenerated_deleteByPrimaryKey"/>
	  <flushOnExecute statement="C_FILE_PATTERNS.ibatorgenerated_insert"/>
	  <flushOnExecute statement="C_FILE_PATTERNS.ibatorgenerated_updateByPrimaryKey"/>
	  <property name="cache-size" value="1000" />
  </cacheModel>
  
  <resultMap class="vo.FilePattern" id="ibatorgenerated_BaseResultMap">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Aug 25 00:33:14 ICT 2010.
    -->
    <result column="PATTERN_ID" jdbcType="DECIMAL" property="patternId" />
    <result column="FILE_PATTERN" jdbcType="VARCHAR" property="filePattern" />
    <result column="NODE_TYPE" jdbcType="VARCHAR" property="nodeType" />
    <result column="RAW_TABLE" jdbcType="VARCHAR" property="rawTable" />
    <result column="CONVERT_CLASS" jdbcType="VARCHAR" property="convertClass" />
    <result column="SUB_DIR" jdbcType="VARCHAR" property="subDir" />
    <result column="NODE_PATTERN_GROUP" jdbcType="DECIMAL" property="nodePatternGroup" />
    <result column="TIME_PATTERN_GROUP" jdbcType="DECIMAL" property="timePatternGroup" />
    <result column="SEPARATOR" jdbcType="VARCHAR" property="separator" />
    <result column="COMMENT_CHAR" jdbcType="VARCHAR" property="commentChar" />
    <result column="TIME_PATTERN" jdbcType="VARCHAR" property="timePattern" />
    <result column="IMPORT_RULE" jdbcType="VARCHAR" property="importRule" />
    <result column="STATUS" property="status" jdbcType="VARCHAR" />
  </resultMap>
  
  <select id="ibatorgenerated_selectByPrimaryKey" parameterClass="vo.FilePattern" resultMap="ibatorgenerated_BaseResultMap">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Aug 25 00:33:14 ICT 2010.
    -->
    select PATTERN_ID, FILE_PATTERN, NODE_TYPE, RAW_TABLE, CONVERT_CLASS, STATUS, SUB_DIR,
      NODE_PATTERN_GROUP, TIME_PATTERN_GROUP, SEPARATOR, COMMENT_CHAR, TIME_PATTERN, IMPORT_RULE
    from C_FILE_PATTERNS
    where PATTERN_ID = #patternId:DECIMAL#
  </select>
  <delete id="ibatorgenerated_deleteByPrimaryKey" parameterClass="vo.FilePattern">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Aug 25 00:33:14 ICT 2010.
    -->
    delete from C_FILE_PATTERNS
    where PATTERN_ID = #patternId:DECIMAL#
  </delete>
  <insert id="ibatorgenerated_insert" parameterClass="vo.FilePattern">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Aug 25 00:33:14 ICT 2010.
    -->
    insert into C_FILE_PATTERNS (PATTERN_ID, FILE_PATTERN, NODE_TYPE, RAW_TABLE, CONVERT_CLASS,
      STATUS, SUB_DIR, NODE_PATTERN_GROUP, TIME_PATTERN_GROUP, SEPARATOR, COMMENT_CHAR,
      TIME_PATTERN, IMPORT_RULE)
    values (#patternId:DECIMAL#, #filePattern:VARCHAR#, #nodeType:VARCHAR#, #rawTable:VARCHAR#,
      #convertClass:VARCHAR#, #status:VARCHAR#, #subDir:VARCHAR#, #nodePatternGroup:DECIMAL#,
      #timePatternGroup:DECIMAL#, #separator:VARCHAR#, #commentChar:VARCHAR#, #timePattern:VARCHAR#,
      #importRule:VARCHAR#)
  </insert>
  <insert id="ibatorgenerated_insertSelective" parameterClass="vo.FilePattern">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Aug 25 00:33:14 ICT 2010.
    -->
    insert into C_FILE_PATTERNS
    <dynamic prepend="(">
      <isNotNull prepend="," property="patternId">
        PATTERN_ID
      </isNotNull>
      <isNotNull prepend="," property="filePattern">
        FILE_PATTERN
      </isNotNull>
      <isNotNull prepend="," property="nodeType">
        NODE_TYPE
      </isNotNull>
      <isNotNull prepend="," property="rawTable">
        RAW_TABLE
      </isNotNull>
      <isNotNull prepend="," property="convertClass">
        CONVERT_CLASS
      </isNotNull>
      <isNotNull prepend="," property="status">
        STATUS
      </isNotNull>
      <isNotNull prepend="," property="subDir">
        SUB_DIR
      </isNotNull>
      <isNotNull prepend="," property="nodePatternGroup">
        NODE_PATTERN_GROUP
      </isNotNull>
      <isNotNull prepend="," property="timePatternGroup">
        TIME_PATTERN_GROUP
      </isNotNull>
      <isNotNull prepend="," property="separator">
        SEPARATOR
      </isNotNull>
      <isNotNull prepend="," property="commentChar">
        COMMENT_CHAR
      </isNotNull>
      <isNotNull prepend="," property="timePattern">
        TIME_PATTERN
      </isNotNull>
      <isNotNull prepend="," property="importRule">
        IMPORT_RULE
      </isNotNull>
      )
    </dynamic>
    values
    <dynamic prepend="(">
      <isNotNull prepend="," property="patternId">
        #patternId:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="filePattern">
        #filePattern:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="nodeType">
        #nodeType:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="rawTable">
        #rawTable:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="convertClass">
        #convertClass:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="status">
        #status:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="subDir">
        #subDir:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="nodePatternGroup">
        #nodePatternGroup:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="timePatternGroup">
        #timePatternGroup:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="separator">
        #separator:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="commentChar">
        #commentChar:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="timePattern">
        #timePattern:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="importRule">
        #importRule:VARCHAR#
      </isNotNull>
      )
    </dynamic>
  </insert>
  <update id="ibatorgenerated_updateByPrimaryKeySelective" parameterClass="vo.FilePattern">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Aug 25 00:33:14 ICT 2010.
    -->
    update C_FILE_PATTERNS
    <dynamic prepend="set">
      <isNotNull prepend="," property="filePattern">
        FILE_PATTERN = #filePattern:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="nodeType">
        NODE_TYPE = #nodeType:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="rawTable">
        RAW_TABLE = #rawTable:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="convertClass">
        CONVERT_CLASS = #convertClass:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="status">
        STATUS = #status:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="subDir">
        SUB_DIR = #subDir:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="nodePatternGroup">
        NODE_PATTERN_GROUP = #nodePatternGroup:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="timePatternGroup">
        TIME_PATTERN_GROUP = #timePatternGroup:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="separator">
        SEPARATOR = #separator:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="commentChar">
        COMMENT_CHAR = #commentChar:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="timePattern">
        TIME_PATTERN = #timePattern:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="importRule">
        IMPORT_RULE = #importRule:VARCHAR#
      </isNotNull>
    </dynamic>
    where PATTERN_ID = #patternId:DECIMAL#
  </update>
  <update id="ibatorgenerated_updateByPrimaryKey" parameterClass="vo.FilePattern">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Aug 25 00:33:14 ICT 2010.
    -->
    update C_FILE_PATTERNS
    set FILE_PATTERN = #filePattern:VARCHAR#,
      NODE_TYPE = #nodeType:VARCHAR#,
      RAW_TABLE = #rawTable:VARCHAR#,
      CONVERT_CLASS = #convertClass:VARCHAR#,
      STATUS = #status:VARCHAR#,
      SUB_DIR = #subDir:VARCHAR#,
      NODE_PATTERN_GROUP = #nodePatternGroup:DECIMAL#,
      TIME_PATTERN_GROUP = #timePatternGroup:DECIMAL#,
      SEPARATOR = #separator:VARCHAR#,
      COMMENT_CHAR = #commentChar:VARCHAR#,
      TIME_PATTERN = #timePattern:VARCHAR#,
      IMPORT_RULE = #importRule:VARCHAR#
    where PATTERN_ID = #patternId:DECIMAL#
  </update>
  
  <select id="getAll" resultMap="ibatorgenerated_BaseResultMap" cacheModel="file-pattern-cache">
	select * from C_FILE_PATTERNS
  </select>
  
 <!--  <select id="filter" resultMap="ibatorgenerated_BaseResultMap1" parameterClass="vo.alarm.utils.FilePatternFilter" cacheModel="file-pattern-cache" >
    select m.*, t.TRANG_THAI
    from C_FILE_PATTERNS m, SYS_PARAMETERS t
    Where  m.STATUS = t.Ma_TT
    <dynamic prepend="and" >
      <isNotEmpty prepend="and" property="filePattern" >
        UPPER(m.FILE_PATTERN) like '%' || UPPER(#filePattern:VARCHAR#) || '%'
      </isNotEmpty>
      <isNotEmpty prepend="and" property="rawTable" >
        UPPER(m.RAW_TABLE) like '%' || UPPER(#rawTable:VARCHAR#) || '%'
      </isNotEmpty>
      <isNotEmpty prepend="and" property="status" >
        UPPER(m.STATUS) = #status:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="and" property="nodeType" >
        UPPER(m.NODE_TYPE) like '%' || UPPER(#nodeType:VARCHAR#) || '%'
      </isNotEmpty>
      <isNotEmpty prepend="and" property="convertClass" >
        UPPER(CONVERT_CLASS) like '%' || UPPER(#convertClass:VARCHAR#) || '%'
      </isNotEmpty>
    </dynamic>
    order by UPPER(m.PATTERN_ID)
  </select> -->
  
  <select id="ibatorgenerated_selectByFilePattern" parameterClass="String" resultMap="ibatorgenerated_BaseResultMap" cacheModel="file-pattern-cache">
    select *
    from  C_FILE_PATTERNS
    where FILE_PATTERN = #value#
  </select>
  
  <resultMap class="vo.FilePattern" id="resultMapFilter">
 	<result column="PATTERN_ID" jdbcType="DECIMAL" property="patternId" />
    <result column="FILE_PATTERN" jdbcType="VARCHAR" property="filePattern" />
    <result column="NODE_TYPE" jdbcType="VARCHAR" property="nodeType" />
    <result column="RAW_TABLE" jdbcType="VARCHAR" property="rawTable" />
    <result column="CONVERT_CLASS" jdbcType="VARCHAR" property="convertClass" />
    <result column="SUB_DIR" jdbcType="VARCHAR" property="subDir" />
    <result column="NODE_PATTERN_GROUP" jdbcType="DECIMAL" property="nodePatternGroup" />
    <result column="TIME_PATTERN_GROUP" jdbcType="DECIMAL" property="timePatternGroup" />
    <result column="SEPARATOR" jdbcType="VARCHAR" property="separator" />
    <result column="COMMENT_CHAR" jdbcType="VARCHAR" property="commentChar" />
    <result column="TIME_PATTERN" jdbcType="VARCHAR" property="timePattern" />
    <result column="IMPORT_RULE" jdbcType="VARCHAR" property="importRule" />
    <result column="STATUS" property="status" jdbcType="VARCHAR" />
  </resultMap>	 
  
  <procedure id="getFilePatternList" parameterClass="java.util.Map" resultMap="resultMapFilter">
      {
	      call PK_IMPORT_MAPPING.PR_FILE_PATTERN_GET
	      (
	      	#P_FILE_PATTERN,jdbcType=VARCHAR,mode=IN#,
	      	#P_NODE_TYPE,jdbcType=VARCHAR,mode=IN#,
	      	#P_CONVERT_CLASS,jdbcType=VARCHAR,mode=IN#,
			#P_RAW_TABLE,jdbcType=VARCHAR,mode=IN#,
			#P_STATUS,jdbcType=VARCHAR,mode=IN#,
			#P_COLUMN,jdbcType=VARCHAR,mode=IN#,
			#P_ORDER,jdbcType=DECIMAL,mode=IN#,
			#P_DATA,jdbcType=ORACLECURSOR,mode=OUT,javaType=java.sql.ResultSet#
		  )
      }
 </procedure>
 
   <resultMap class="vo.SYS_PARAMETER" id="resultTitleForm">
	    <result column="ID" jdbcType="DECIMAL" property="id" />
	    <result column="CODE" jdbcType="NVARCHAR" property="code" />
	    <result column="NAME" jdbcType="NVARCHAR" property="name" />
	    <result column="VALUE" jdbcType="NVARCHAR" property="value" />
	    <result column="ORDERING" jdbcType="DECIMAL" property="ordering" />
	    <result column="DATA_TYPE" jdbcType="NVARCHAR" property="dataType" />
	    <result column="CREATED_BY" jdbcType="NVARCHAR" property="createdBy" />
	    <result column="CREATE_DATE" jdbcType="TIMESTAMP" property="createDate" />
	    <result column="MODIFIED_BY" jdbcType="NVARCHAR" property="modifiedBy" />
	    <result column="MODIFY_DATE" jdbcType="TIMESTAMP" property="modifyDate" />
	    <result column="REMARK" jdbcType="NVARCHAR" property="remark" />
	  </resultMap>
    <procedure id="titleFilePatten" resultMap="resultTitleForm">
	      {
	      	call PK_IMPORT_MAPPING.PR_GET_TITLE_FILE_PATTERN
	      	(
	      		#P_TYPE_FORM,jdbcType=VARCHAR,mode=IN,javaType=java.lang.String#,
		      	#P_DATA,jdbcType=ORACLECURSOR,mode=OUT,javaType=java.sql.ResultSet#
	      	)
	      }
  </procedure>
  
    
    <select id="selectByFilePatternAndConvertClass" parameterClass="vo.FilePattern" resultMap="ibatorgenerated_BaseResultMap">
    
    select PATTERN_ID, FILE_PATTERN, NODE_TYPE, RAW_TABLE, CONVERT_CLASS, STATUS, SUB_DIR,
      NODE_PATTERN_GROUP, TIME_PATTERN_GROUP, SEPARATOR, COMMENT_CHAR, TIME_PATTERN, IMPORT_RULE
    from C_FILE_PATTERNS
    where FILE_PATTERN = #filePattern:VARCHAR#
    and CONVERT_CLASS= #convertClass:VARCHAR#
  </select>
</sqlMap>
