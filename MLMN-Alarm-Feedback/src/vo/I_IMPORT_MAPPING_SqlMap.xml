<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="I_IMPORT_MAPPING">
  <resultMap class="vo.ImportMapping" id="ibatorgenerated_BaseResultMap">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Feb 21 16:03:45 ICT 2013.
    -->
    <result column="PATTERN_ID" jdbcType="DECIMAL" property="patternId" />
    <result column="RAW_TABLE" jdbcType="VARCHAR" property="rawTable" />
    <result column="TABLE_COLUMN" jdbcType="VARCHAR" property="tableColumn" />
    <result column="FILE_COLUMN" jdbcType="DECIMAL" property="fileColumn" />
    <result column="DATA_TYPE" jdbcType="VARCHAR" property="dataType" />
    <result column="DATA_FORMAT" jdbcType="VARCHAR" property="dataFormat" />
    <result column="CREATE_DATE" jdbcType="TIMESTAMP" property="createDate" />
    <result column="CREATE_BY" jdbcType="VARCHAR" property="createBy" />
    <result column="FILE_COLUMN_HEADER" jdbcType="VARCHAR" property="fileColumnHeader" />
    <result column="STATUS" jdbcType="VARCHAR" property="status" />
  </resultMap>
  
  <delete id="ibatorgenerated_deleteByPrimaryKey" parameterClass="vo.ImportMapping">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Feb 21 16:03:45 ICT 2013.
    -->
    delete from I_IMPORT_MAPPING
    where PATTERN_ID = #patternId:DECIMAL#
      and RAW_TABLE = #rawTable:VARCHAR#
      and TABLE_COLUMN = #tableColumn:VARCHAR#
  </delete>
  <insert id="ibatorgenerated_insert" parameterClass="vo.ImportMapping">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Feb 21 16:03:45 ICT 2013.
    -->
    insert into I_IMPORT_MAPPING (PATTERN_ID, RAW_TABLE, TABLE_COLUMN, FILE_COLUMN, DATA_TYPE,
      DATA_FORMAT, CREATE_DATE, CREATE_BY, FILE_COLUMN_HEADER, STATUS)
    values (#patternId:DECIMAL#, #rawTable:VARCHAR#, #tableColumn:VARCHAR#, #fileColumn:DECIMAL#,
      #dataType:VARCHAR#, #dataFormat:VARCHAR#, #createDate:TIMESTAMP#, #createBy:VARCHAR#,
      #fileColumnHeader:VARCHAR#, #status:VARCHAR#)
  </insert>
  <insert id="ibatorgenerated_insertSelective" parameterClass="vo.ImportMapping">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Feb 21 16:03:45 ICT 2013.
    -->
    insert into I_IMPORT_MAPPING
    <dynamic prepend="(">
      <isNotNull prepend="," property="patternId">
        PATTERN_ID
      </isNotNull>
      <isNotNull prepend="," property="rawTable">
        RAW_TABLE
      </isNotNull>
      <isNotNull prepend="," property="tableColumn">
        TABLE_COLUMN
      </isNotNull>
      <isNotNull prepend="," property="fileColumn">
        FILE_COLUMN
      </isNotNull>
      <isNotNull prepend="," property="dataType">
        DATA_TYPE
      </isNotNull>
      <isNotNull prepend="," property="dataFormat">
        DATA_FORMAT
      </isNotNull>
      <isNotNull prepend="," property="createDate">
        CREATE_DATE
      </isNotNull>
      <isNotNull prepend="," property="createBy">
        CREATE_BY
      </isNotNull>
      <isNotNull prepend="," property="fileColumnHeader">
        FILE_COLUMN_HEADER
      </isNotNull>
      <isNotNull prepend="," property="status">
        STATUS
      </isNotNull>
      )
    </dynamic>
    values
    <dynamic prepend="(">
      <isNotNull prepend="," property="patternId">
        #patternId:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="rawTable">
        #rawTable:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="tableColumn">
        #tableColumn:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="fileColumn">
        #fileColumn:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="dataType">
        #dataType:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="dataFormat">
        #dataFormat:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="createDate">
        #createDate:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="createBy">
        #createBy:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="fileColumnHeader">
        #fileColumnHeader:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="status">
        #status:VARCHAR#
      </isNotNull>
      )
    </dynamic>
  </insert>
  <update id="ibatorgenerated_updateByPrimaryKeySelective" parameterClass="vo.ImportMapping">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Feb 21 16:03:45 ICT 2013.
    -->
    update I_IMPORT_MAPPING
    <dynamic prepend="set">
      <isNotNull prepend="," property="fileColumn">
        FILE_COLUMN = #fileColumn:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="dataType">
        DATA_TYPE = #dataType:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="dataFormat">
        DATA_FORMAT = #dataFormat:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="createDate">
        CREATE_DATE = #createDate:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="createBy">
        CREATE_BY = #createBy:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="fileColumnHeader">
        FILE_COLUMN_HEADER = #fileColumnHeader:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="status">
        STATUS = #status:VARCHAR#
      </isNotNull>
    </dynamic>
    where PATTERN_ID = #patternId:DECIMAL#
      and RAW_TABLE = #rawTable:VARCHAR#
      and TABLE_COLUMN = #tableColumn:VARCHAR#
  </update>
  <update id="ibatorgenerated_updateByPrimaryKey" parameterClass="vo.ImportMapping">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Feb 21 16:03:45 ICT 2013.
    -->
    update I_IMPORT_MAPPING
    set FILE_COLUMN = #fileColumn:DECIMAL#,
      DATA_TYPE = #dataType:VARCHAR#,
      DATA_FORMAT = #dataFormat:VARCHAR#,
      CREATE_DATE = #createDate:TIMESTAMP#,
      CREATE_BY = #createBy:VARCHAR#,
      FILE_COLUMN_HEADER = #fileColumnHeader:VARCHAR#,
      STATUS = #status:VARCHAR#
    where PATTERN_ID = #patternId:DECIMAL#
      and RAW_TABLE = #rawTable:VARCHAR#
      and TABLE_COLUMN = #tableColumn:VARCHAR#
  </update>
  
  <select id="getAll" resultMap="ibatorgenerated_BaseResultMap">
	select m.*, p.FILE_PATTERN, t.TRANG_THAI
    from I_IMPORT_MAPPING m, C_FILE_PATTERNS p, SYS_PARAMETER t
    where m.PATTERN_ID = p.PATTERN_ID
    and	  m.STATUS = t.MA_TT
  </select>
  
  <!-- <select id="filter" parameterClass="vo.alarm.utils.ImportMappingFilter" resultMap="ibatorgenerated_BaseResultMap1">
    select m.PATTERN_ID,m.RAW_TABLE,m.FILE_COLUMN,m.DATA_TYPE,TABLE_COLUMN,m.DATA_FORMAT,
    	   m.FILE_COLUMN_HEADER, p.FILE_PATTERN,t.TRANG_THAI
    from I_IMPORT_MAPPING m, C_FILE_PATTERNS p, SYS_PARAMETER t
    where m.PATTERN_ID = p.PATTERN_ID
     and	m.STATUS = t.Ma_TT
    <dynamic prepend="and">
      <isNotEmpty prepend="and" property="filePattern">
        UPPER(p.FILE_PATTERN) like '%' || UPPER(#filePattern:VARCHAR#) || '%'
      </isNotEmpty>
      <isNotEmpty prepend="and" property="rawTable">
        UPPER(m.RAW_TABLE) like '%' || UPPER(#rawTable:VARCHAR#) || '%'
      </isNotEmpty>
      <isNotEmpty prepend="and" property="status">
        m.STATUS = #status:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="and" property="tableColumn">
        UPPER(m.TABLE_COLUMN) like '%' ||UPPER(#tableColumn:VARCHAR#)|| '%'
      </isNotEmpty>
      <isNotEmpty prepend="and" property="fileColumnHeader">
        UPPER(m.FILE_COLUMN_HEADER) like '%' ||UPPER(#fileColumnHeader:VARCHAR#)|| '%'
      </isNotEmpty>
    </dynamic>
    order by UPPER(m.RAW_TABLE)
  </select> -->
  
  <resultMap class="vo.ImportMapping" id="resultMapFilter">
 	<result column="PATTERN_ID" jdbcType="DECIMAL" property="patternId" />
    <result column="RAW_TABLE" jdbcType="VARCHAR" property="rawTable" />
    <result column="TABLE_COLUMN" jdbcType="VARCHAR" property="tableColumn" />
    <result column="FILE_COLUMN" jdbcType="DECIMAL" property="fileColumn" />
    <result column="DATA_TYPE" jdbcType="VARCHAR" property="dataType" />
    <result column="DATA_FORMAT" jdbcType="VARCHAR" property="dataFormat" />
    <result column="CREATE_DATE" jdbcType="TIMESTAMP" property="createDate" />
    <result column="CREATE_BY" jdbcType="VARCHAR" property="createBy" />
    <result column="FILE_COLUMN_HEADER" jdbcType="VARCHAR" property="fileColumnHeader" />
    <result column="STATUS" jdbcType="VARCHAR" property="status" />
  	<result column="FILE_PATTERN" property="filePattern" />
  
  </resultMap>	 
  
  <select id="ibatorgenerated_selectByPrimaryKey" parameterClass="vo.ImportMapping" resultMap="resultMapFilter">
  
    select m.PATTERN_ID, m.RAW_TABLE, m.TABLE_COLUMN, m.FILE_COLUMN, m.DATA_TYPE, m.DATA_FORMAT, m.CREATE_DATE,
      m.CREATE_BY, m.FILE_COLUMN_HEADER, m.STATUS, p.FILE_PATTERN
    from I_IMPORT_MAPPING m
    left join C_FILE_PATTERNS p
    on m.PATTERN_ID = p.PATTERN_ID
    where m.PATTERN_ID = #patternId:DECIMAL#
      and m.RAW_TABLE = #rawTable:VARCHAR#
      and m.TABLE_COLUMN = #tableColumn:VARCHAR#
  </select>
  
   <procedure id="getImportMappingList" parameterClass="java.util.Map" resultMap="resultMapFilter">
      {
	      call PK_IMPORT_MAPPING.PR_IMPORT_MAPPING_GET
	      (
	      	#P_RAW_TABLE,jdbcType=VARCHAR,mode=IN#,
	      	#P_FILE_PATTERN,jdbcType=VARCHAR,mode=IN#,
	      	#P_FILE_COLUMN_HEADER,jdbcType=VARCHAR,mode=IN#,
			#P_TABLE_COLUMN,jdbcType=VARCHAR,mode=IN#,
			#P_STATUS,jdbcType=VARCHAR,mode=IN#,
			#P_COLUMN,jdbcType=VARCHAR,mode=IN#,
			#P_ORDER,jdbcType=DECIMAL,mode=IN#,
			#P_DATA,jdbcType=ORACLECURSOR,mode=OUT,javaType=java.sql.ResultSet#
		  )
      }
 </procedure>
   <resultMap class="vo.SYS_PARAMETER" id="resultTitleForm">
	    <result column="ID" jdbcType="DECIMAL" property="id" />
	    <result column="CODE" jdbcType="NVARCHAR" property="code" />
	    <result column="NAME" jdbcType="NVARCHAR" property="name" />
	    <result column="VALUE" jdbcType="NVARCHAR" property="value" />
	    <result column="ORDERING" jdbcType="DECIMAL" property="ordering" />
	    <result column="DATA_TYPE" jdbcType="NVARCHAR" property="dataType" />
	    <result column="CREATED_BY" jdbcType="NVARCHAR" property="createdBy" />
	    <result column="CREATE_DATE" jdbcType="TIMESTAMP" property="createDate" />
	    <result column="MODIFIED_BY" jdbcType="NVARCHAR" property="modifiedBy" />
	    <result column="MODIFY_DATE" jdbcType="TIMESTAMP" property="modifyDate" />
	    <result column="REMARK" jdbcType="NVARCHAR" property="remark" />
	  </resultMap>
    <procedure id="titleImportMapping" resultMap="resultTitleForm">
	      {
	      	call PK_IMPORT_MAPPING.PR_GET_TITLE_IMPORT_MAPPING
	      	(
	      		#P_TYPE_FORM,jdbcType=VARCHAR,mode=IN,javaType=java.lang.String#,
		      	#P_DATA,jdbcType=ORACLECURSOR,mode=OUT,javaType=java.sql.ResultSet#
	      	)
	      }
  </procedure>
</sqlMap>